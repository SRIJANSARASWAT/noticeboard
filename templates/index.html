<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Noticeboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <link href="{{ STATIC_URL }}bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <style type="text/css">
      @font-face {
      font-family: 'Glyphicons Halflings';
      src: url('{{ STATIC_URL }}glyphicons-halflings-regular.eot');
      src: url('{{ STATIC_URL }}glyphicons-halflings-regular.eot?#iefix') format('embedded-opentype'),
        url('{{ STATIC_URL }}glyphicons-halflings-regular.woff') format('woff'),
        url('{{ STATIC_URL }}glyphicons-halflings-regular.ttf') format('truetype'),
        url('{{ STATIC_URL }}glyphicons-halflings-regular.svg#glyphicons-halflingsregular') format('svg');
      }

      .jumbotron-masthead {
        background-image:url('{{ STATIC_URL }}header_background.png');
      }
    </style>

  </head>

  <body>
    <div class="jumbotron jumbotron-masthead">
    <div class="container-narrow", style="text-align:center">
      <h1 style="color:#EEEEEE">Noticeboard</h1>
      <button type="button", class="btn btn-success btn-lg", onClick="new_notice()">Write a New Notice</button>
    </div>
    </div>

    <div class="container">


      <!-- Old notices -->
      {% if noticeList %}
      {% for notice in noticeList %}
      
      {% if forloop.counter0|divisibleby:3 %}
      <div class="row">
      {% endif %}
        <div class="col-md-4", style="padding:10px;">
        <div class="jumbotron", style="background-color:#eee8d5">
          <div class="row">
            <p>{{ notice.notice|linebreaksbr }}</p>
            <div id="note{{ notice.id }}", class="hidden">{{notice.notice}}</div>
          </div>
          
          <div class="row pull-right">
            <button type="button" class="btn btn-link" onclick="delete_notice('/notices/{{ notice.id }}/delete/')"><span class="glyphicon glyphicon-trash"></span></button>
            <button type="button" class="btn btn-link info_button" data-title="Posted" data-content="{{ notice.pub_date }}"><span class="glyphicon glyphicon-time"></span></button>
            <button type="button" class="btn btn-link" onclick="edit_notice(note{{ notice.id }}, '/notices/{{ notice.id }}/edit/')"><span class="glyphicon glyphicon-pencil"></span></button>
          </div>
        </div>
        </div>
        {% if forloop.counter|divisibleby:3 or forloop.last%}</div>{% endif %}
        {% endfor %}
      {% endif %}

    </div> <!-- container -->
       
    <!-- Confirm delete modal -->
    <div id="deleteModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-body">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
              <h4 class="modal-title">Delete Notice</h4>
          </div>
      
          <form action="#", method="post", id="deleteModalForm">
          {% csrf_token %}

          <div class="modal-footer">
              <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
              <button type="submit", class="btn btn-danger">Delete</button>
          </div>
          </form>
        </div>
      </div>
    </div>


    <!-- Edit modal -->
    <div id="editModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h4 class="modal-title">Edit Notice</h4>
          </div>
          
          <form action="#", method="post", id="editModalForm">
          {% csrf_token %}
          <div class="modal-body">
              <div class="row">
                <div class="span5">
                  <textarea class="form-control", rows="3", id="editModalTextarea", name="text_input"></textarea>
                </div>
              </div>
          </div>

          <div class="modal-footer">
            <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
            <button class="btn btn-primary" id="editModalSave">Save</button>
          </div>
          </form>
        </div>
      </div>
    </div>


    <!-- New notice modal -->
    <div id="newModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">

          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h4 class="modal-title">Write a New Notice</h4>
          </div>

          <form action="/notices/new/", method="post", id="newModalForm">
          {% csrf_token %}
          <div class="modal-body">
              <div class="row">
                <div class="span5">
                  <textarea class="form-control", rows="3", id="newModalTextarea", name="text_input"></textarea>
                </div>
              </div>
          </div>

          <div class="modal-footer">
            <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
            <button class="btn btn-success" id="newModalSave">Post</button>
          </div>
          </form>
        </div>
      </div>
    </div>

    
    <script src="{{ STATIC_URL }}jquery-1.10.2.min.js"></script>
    <script src="{{ STATIC_URL }}bootstrap.min.js"></script>
    
    <!-- Popover button function -->
    <script>  
      $(function ()  
      { $(".info_button").popover({placement:'top'});
      });  
    </script>

    <!-- Scripts to load the modal forms -->
    <script type="text/javascript">
      function edit_notice(noticeID, formAction) {
        // Display the text modal and change the text to match
        $('#editModal').modal()
        $('#editModal').on('shown', function () {
          $('#editModalTextarea').focus();
        })
        document.getElementById("editModalTextarea").value = $(noticeID).text()
        document.getElementById("editModalForm").action = formAction
      }

      function delete_notice(formAction) {
        $('#deleteModal').modal()
        document.getElementById("deleteModalForm").action = formAction
      }

      function new_notice() {
        $('#newModal').modal()
        $('#newModal').on('shown', function () {
          $('#newModalTextarea').focus();
        })
      }
    </script>

  </body>
</html>